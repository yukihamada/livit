# ホームページをSupabaseの実データに接続

## タスクリスト

- [x] モックデータ（mockLiveStreams）を削除
- [x] getLiveStreams関数をインポート
- [x] useEffectでデータ取得を実装
- [x] ローディング状態の追加
- [x] エラーハンドリングの実装
- [x] LiveStreamインターフェースをStream型に変更
- [x] 商品データの型を調整
- [ ] カテゴリーデータもDBから取得するか検討
- [x] リフレッシュ機能を実データ取得に変更

## 実装計画

1. **型定義の調整**
   - LiveStreamインターフェースを削除し、Stream型を使用
   - 商品データの型を調整（products配列を含む）

2. **データ取得の実装**
   - useEffectでコンポーネントマウント時にデータ取得
   - ローディング状態とエラー状態の管理
   - リフレッシュ機能の実装

3. **UIの調整**
   - LiveStreamCardコンポーネントに渡すデータ形式の調整
   - verified属性の対応（現在のDBスキーマでは対応する項目がないため検討が必要）

## 注意事項
- use clientディレクティブを維持
- エラー時のフォールバック表示を実装
- データ取得中のローディング表示を追加

## レビュー

### 実装した変更内容

1. **モックデータの削除とSupabaseデータ連携**
   - mockLiveStreamsを削除し、getLiveStreams関数でSupabaseから実データを取得
   - ExtendedStream型を定義して、Stream型を拡張し商品データを含められるように対応

2. **ローディング状態の実装**
   - isLoading stateを追加
   - データ取得中はスピナーアイコンを表示

3. **エラーハンドリング**
   - error stateを追加
   - エラー発生時は警告アイコンとエラーメッセージを表示
   - 再試行ボタンを設置

4. **データ取得処理**
   - fetchStreams関数を作成し、useEffectでコンポーネントマウント時に実行
   - リフレッシュボタンでも同じ関数を使用

5. **型の調整**
   - LiveStreamCardコンポーネントが期待する形式にデータを変換
   - verified属性は現在のDBスキーマにないため、一旦falseに設定
   - 商品の割引率は、specialPriceとpriceから計算

### 今後の検討事項

1. **カテゴリーデータのDB化**
   - 現在はハードコードされているカテゴリーをDBから取得するか検討が必要

2. **verified属性の対応**
   - profilesテーブルにis_verified列を追加するか、別の方法で認証済みストリーマーを判定する仕組みが必要

3. **画像URLのフォールバック**
   - thumbnailUrlやavatar_urlがnullの場合のプレースホルダー画像を使用しているが、より適切なデフォルト画像の検討が必要